version: "3"

services:
  artifactory:
    container_name: artifactory
    image: docker.bintray.io/jfrog/artifactory-oss
    ports:
      - "9001:8081"
    volumes:
      - "artifactory:/var/opt/jfrog/artifactory"

  gitlab:
    container_name: gitlab
    image: gitlab/gitlab-ce
    ports:
      - "9002:80"
      - "9042:443"
      - "9022:22"
    volumes:
      - gitlab-config:/etc/gitlab
      - gitlab-logs:/var/log/gitlab
      - gitlab-data:/var/opt/gitlab

  teamcity:
    container_name: teamcity
    image: jetbrains/teamcity-server
    ports:
      - "9003:8111"
    volumes:
      - "teamcity-data:/data/teamcity_server/datadir"
      - "teamcity-logs:/opt/teamcity/logs"

  maven:
    container_name: maven
    image: maven:3.3-jdk-8-alpine
    volumes:
      - "$PWD"/ci-modulo-dependencia:/usr/src/build \
    -v "$PWD"/docker/settings.xml:/usr/share/maven/ref/settings.xml \

volumes:
  teamcity-data:
  teamcity-logs:
  artifactory:
  gitlab-config:
  gitlab-logs:
  gitlab-data: